/*!
 * mousekey v1.0.12
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("child_process"),require("util"),require("path"),require("fs")):"function"==typeof define&&define.amd?define(["child_process","util","path","fs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).mousekey=e(t.child_process,t.util,t.path,t.fs)}(this,function(t,e,r,n){"use strict";var o=Array.isArray,i="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,c=i||a||Function("return this")(),u=c.Symbol,s=Object.prototype,l=s.hasOwnProperty,f=s.toString,h=u?u.toStringTag:void 0;var p=Object.prototype.toString;var y=u?u.toStringTag:void 0;function _(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":y&&y in Object(t)?function(t){var e=l.call(t,h),r=t[h];try{t[h]=void 0;var n=!0}catch(t){}var o=f.call(t);return n&&(e?t[h]=r:delete t[h]),o}(t):function(t){return p.call(t)}(t)}function d(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==_(t)}var v=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/;function b(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var k,j=c["__core-js_shared__"],S=(k=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"";var $=Function.prototype.toString;var m=/^\[object .+?Constructor\]$/,w=Function.prototype,P=Object.prototype,O=w.toString,z=P.hasOwnProperty,x=RegExp("^"+O.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function A(t){if(!b(t)||(e=t,S&&S in e))return!1;var e,r=function(t){if(!b(t))return!1;var e=_(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)?x:m;return r.test(function(t){if(null!=t){try{return $.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function E(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return A(r)?r:void 0}var C=E(Object,"create");var F=Object.prototype.hasOwnProperty;var T=Object.prototype.hasOwnProperty;function H(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function q(t,e){return t===e||t!=t&&e!=e}function D(t,e){for(var r=t.length;r--;)if(q(t[r][0],e))return r;return-1}H.prototype.clear=function(){this.__data__=C?C(null):{},this.size=0},H.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},H.prototype.get=function(t){var e=this.__data__;if(C){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return F.call(e,t)?e[t]:void 0},H.prototype.has=function(t){var e=this.__data__;return C?void 0!==e[t]:T.call(e,t)},H.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=C&&void 0===e?"__lodash_hash_undefined__":e,this};var R=Array.prototype.splice;function G(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}G.prototype.clear=function(){this.__data__=[],this.size=0},G.prototype.delete=function(t){var e=this.__data__,r=D(e,t);return!(r<0)&&(r==e.length-1?e.pop():R.call(e,r,1),--this.size,!0)},G.prototype.get=function(t){var e=this.__data__,r=D(e,t);return r<0?void 0:e[r][1]},G.prototype.has=function(t){return D(this.__data__,t)>-1},G.prototype.set=function(t,e){var r=this.__data__,n=D(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var I=E(c,"Map");function K(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function L(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}L.prototype.clear=function(){this.size=0,this.__data__={hash:new H,map:new(I||G),string:new H}},L.prototype.delete=function(t){var e=K(this,t).delete(t);return this.size-=e?1:0,e},L.prototype.get=function(t){return K(this,t).get(t)},L.prototype.has=function(t){return K(this,t).has(t)},L.prototype.set=function(t,e){var r=K(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function M(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(M.Cache||L),r}M.Cache=L;var N,U,B,J=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q=/\\(\\)?/g,V=(N=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(J,function(t,r,n,o){e.push(n?o.replace(Q,"$1"):r||t)}),e},U=M(N,function(t){return 500===B.size&&B.clear(),t}),B=U.cache,U),W=V;var X=u?u.prototype:void 0,Y=X?X.toString:void 0;function Z(t){if("string"==typeof t)return t;if(o(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,Z)+"";if(d(t))return Y?Y.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function tt(t,e){return o(t)?t:function(t,e){if(o(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!d(t))||g.test(t)||!v.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:W(function(t){return null==t?"":Z(t)}(t))}function et(t){if("string"==typeof t||d(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function rt(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=tt(e,t)).length;null!=t&&r<n;)t=t[et(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function nt(t){return function(t,e={}){let r=rt(e,"fs");return!!r.existsSync(t)&&!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink()}(t,{fs:n})}let ot=e.promisify(t.execFile),it=function(){let t=r.resolve(),e="AutoHotkey64.exe",n="";{let r=`${t}/AutoHotkey_2.0.19/`,o=`${t}/node_modules/w-mousekey/AutoHotkey_2.0.19/`;if(nt(`${r}${e}`))n=r;else{if(!nt(`${o}${e}`))throw new Error("can not find folder for AutoHotkey");n=o}}return{ahkExePath:`${n}/AutoHotkey64.exe`,ahkScriptPathClick:`${n}/zclick.ahk`,ahkScriptPathDrag:`${n}/zdrag.ahk`,ahkScriptPathSend:`${n}/zsend.ahk`,ahkScriptPathRecord:`${n}/zrecord.ahk`}}();async function at(t,e,r=[]){let n=function(){let t,e,r=new Promise(function(){t=arguments[0],e=arguments[1]});return r.resolve=t,r.reject=e,r}();try{let{stdout:o,stderr:i}=await ot(t,["/force",e,...r]);i?n.reject(i):n.resolve(o)}catch(t){n.reject(t)}return n}return{mouseClick:async function(t,e){await at(it.ahkExePath,it.ahkScriptPathClick,[t,e])},mouseDrag:async function(t,e,r,n){await at(it.ahkExePath,it.ahkScriptPathDrag,[t,e,r,n])},sendKey:async function(t){await at(it.ahkExePath,it.ahkScriptPathSend,[`${t}`])},sendString:async function(t){await at(it.ahkExePath,it.ahkScriptPathSend,[`${t}`])}}});
//# sourceMappingURL=mousekey.umd.js.map
